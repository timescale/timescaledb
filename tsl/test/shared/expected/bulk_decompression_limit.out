-- This file and its contents are licensed under the Timescale License.
-- Please see the included NOTICE for copyright information and
-- LICENSE-TIMESCALE for a copy of the license.
-- Test that bulk decompression is automatically disabled for small limits.
EXPLAIN (ANALYZE, VERBOSE, COSTS OFF, TIMING OFF, SUMMARY OFF, BUFFERS OFF)
SELECT time, device_id, v0 FROM metrics_compressed
WHERE device_id = 1
ORDER BY time
LIMIT 5;
--- QUERY PLAN ---
 Limit (actual rows=5.00 loops=1)
   Output: metrics_compressed."time", metrics_compressed.device_id, metrics_compressed.v0
   ->  Custom Scan (ChunkAppend) on public.metrics_compressed (actual rows=5.00 loops=1)
         Output: metrics_compressed."time", metrics_compressed.device_id, metrics_compressed.v0
         Order: metrics_compressed."time"
         Startup Exclusion: false
         Runtime Exclusion: false
         ->  Merge Append (actual rows=5.00 loops=1)
               Sort Key: metrics_compressed."time"
               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (actual rows=1.00 loops=1)
                     Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
                     Filter: (_hyper_X_X_chunk.device_id = 1)
                     Chunk Status: PARTIAL
                     Reverse: true
                     Bulk Decompression: false
                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
                           Output: compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk._ts_meta_count
                           Index Cond: (compress_hyper_X_X_chunk.device_id = 1)
               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _timescaledb_internal._hyper_X_X_chunk (actual rows=5.00 loops=1)
                     Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
                     Filter: (_hyper_X_X_chunk.device_id = 1)
         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (never executed)
               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
               Reverse: true
               Bulk Decompression: false
               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (never executed)
                     Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
                     Index Cond: (compress_hyper_X_X_chunk.device_id = 1)
         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (never executed)
               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
               Reverse: true
               Bulk Decompression: false
               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (never executed)
                     Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
                     Index Cond: (compress_hyper_X_X_chunk.device_id = 1)

EXPLAIN (ANALYZE, VERBOSE, COSTS OFF, TIMING OFF, SUMMARY OFF, BUFFERS OFF)
SELECT time, device_id, v0 FROM metrics_compressed
WHERE device_id = 1
ORDER BY time
OFFSET 5;
--- QUERY PLAN ---
 Limit (actual rows=13669.00 loops=1)
   Output: metrics_compressed."time", metrics_compressed.device_id, metrics_compressed.v0
   ->  Custom Scan (ChunkAppend) on public.metrics_compressed (actual rows=13674.00 loops=1)
         Output: metrics_compressed."time", metrics_compressed.device_id, metrics_compressed.v0
         Order: metrics_compressed."time"
         Startup Exclusion: false
         Runtime Exclusion: false
         ->  Merge Append (actual rows=3598.00 loops=1)
               Sort Key: metrics_compressed."time"
               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (actual rows=2000.00 loops=1)
                     Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
                     Filter: (_hyper_X_X_chunk.device_id = 1)
                     Chunk Status: PARTIAL
                     Reverse: true
                     Bulk Decompression: true
                     ->  Sort (actual rows=2.00 loops=1)
                           Output: compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk._ts_meta_count
                           Sort Key: compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
                           Sort Method: quicksort 
                           ->  Seq Scan on _timescaledb_internal.compress_hyper_X_X_chunk (actual rows=2.00 loops=1)
                                 Output: compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk._ts_meta_count
                                 Filter: (compress_hyper_X_X_chunk.device_id = 1)
                                 Rows Removed by Filter: 16
               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _timescaledb_internal._hyper_X_X_chunk (actual rows=1598.00 loops=1)
                     Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
                     Filter: (_hyper_X_X_chunk.device_id = 1)
         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (actual rows=5038.00 loops=1)
               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
               Reverse: true
               Bulk Decompression: true
               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
                     Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
                     Index Cond: (compress_hyper_X_X_chunk.device_id = 1)
         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (actual rows=5038.00 loops=1)
               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
               Reverse: true
               Bulk Decompression: true
               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
                     Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
                     Index Cond: (compress_hyper_X_X_chunk.device_id = 1)

EXPLAIN (ANALYZE, VERBOSE, COSTS OFF, TIMING OFF, SUMMARY OFF, BUFFERS OFF)
SELECT time, device_id, v0 FROM metrics_compressed
WHERE device_id = 1
ORDER BY time
LIMIT 0;
--- QUERY PLAN ---
 Limit (actual rows=0.00 loops=1)
   Output: metrics_compressed."time", metrics_compressed.device_id, metrics_compressed.v0
   ->  Custom Scan (ChunkAppend) on public.metrics_compressed (never executed)
         Output: metrics_compressed."time", metrics_compressed.device_id, metrics_compressed.v0
         Order: metrics_compressed."time"
         Startup Exclusion: false
         Runtime Exclusion: false
         ->  Merge Append (never executed)
               Sort Key: metrics_compressed."time"
               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (never executed)
                     Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
                     Filter: (_hyper_X_X_chunk.device_id = 1)
                     Chunk Status: PARTIAL
                     Reverse: true
                     Bulk Decompression: false
                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (never executed)
                           Output: compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk._ts_meta_count
                           Index Cond: (compress_hyper_X_X_chunk.device_id = 1)
               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _timescaledb_internal._hyper_X_X_chunk (never executed)
                     Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
                     Filter: (_hyper_X_X_chunk.device_id = 1)
         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (never executed)
               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
               Reverse: true
               Bulk Decompression: false
               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (never executed)
                     Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
                     Index Cond: (compress_hyper_X_X_chunk.device_id = 1)
         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (never executed)
               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
               Reverse: true
               Bulk Decompression: false
               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (never executed)
                     Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
                     Index Cond: (compress_hyper_X_X_chunk.device_id = 1)

EXPLAIN (ANALYZE, VERBOSE, COSTS OFF, TIMING OFF, SUMMARY OFF, BUFFERS OFF)
SELECT time, device_id, v0 FROM metrics_compressed
WHERE device_id = 1
ORDER BY time
OFFSET 0;
--- QUERY PLAN ---
 Custom Scan (ChunkAppend) on public.metrics_compressed (actual rows=13674.00 loops=1)
   Output: metrics_compressed."time", metrics_compressed.device_id, metrics_compressed.v0
   Order: metrics_compressed."time"
   Startup Exclusion: false
   Runtime Exclusion: false
   ->  Merge Append (actual rows=3598.00 loops=1)
         Sort Key: metrics_compressed."time"
         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (actual rows=2000.00 loops=1)
               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
               Filter: (_hyper_X_X_chunk.device_id = 1)
               Chunk Status: PARTIAL
               Reverse: true
               Bulk Decompression: true
               ->  Sort (actual rows=2.00 loops=1)
                     Output: compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk._ts_meta_count
                     Sort Key: compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
                     Sort Method: quicksort 
                     ->  Seq Scan on _timescaledb_internal.compress_hyper_X_X_chunk (actual rows=2.00 loops=1)
                           Output: compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk._ts_meta_count
                           Filter: (compress_hyper_X_X_chunk.device_id = 1)
                           Rows Removed by Filter: 16
         ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _timescaledb_internal._hyper_X_X_chunk (actual rows=1598.00 loops=1)
               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
               Filter: (_hyper_X_X_chunk.device_id = 1)
   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (actual rows=5038.00 loops=1)
         Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
         Reverse: true
         Bulk Decompression: true
         ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
               Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
               Index Cond: (compress_hyper_X_X_chunk.device_id = 1)
   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (actual rows=5038.00 loops=1)
         Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
         Reverse: true
         Bulk Decompression: true
         ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
               Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
               Index Cond: (compress_hyper_X_X_chunk.device_id = 1)

EXPLAIN (ANALYZE, VERBOSE, COSTS OFF, TIMING OFF, SUMMARY OFF, BUFFERS OFF)
SELECT time, device_id, v0 FROM metrics_compressed
WHERE device_id = 1
ORDER BY time
LIMIT 10000;
--- QUERY PLAN ---
 Limit (actual rows=10000.00 loops=1)
   Output: metrics_compressed."time", metrics_compressed.device_id, metrics_compressed.v0
   ->  Custom Scan (ChunkAppend) on public.metrics_compressed (actual rows=10000.00 loops=1)
         Output: metrics_compressed."time", metrics_compressed.device_id, metrics_compressed.v0
         Order: metrics_compressed."time"
         Startup Exclusion: false
         Runtime Exclusion: false
         ->  Merge Append (actual rows=3598.00 loops=1)
               Sort Key: metrics_compressed."time"
               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (actual rows=2000.00 loops=1)
                     Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
                     Filter: (_hyper_X_X_chunk.device_id = 1)
                     Chunk Status: PARTIAL
                     Reverse: true
                     Bulk Decompression: true
                     ->  Sort (actual rows=2.00 loops=1)
                           Output: compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk._ts_meta_count
                           Sort Key: compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
                           Sort Method: quicksort 
                           ->  Seq Scan on _timescaledb_internal.compress_hyper_X_X_chunk (actual rows=2.00 loops=1)
                                 Output: compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk._ts_meta_count
                                 Filter: (compress_hyper_X_X_chunk.device_id = 1)
                                 Rows Removed by Filter: 16
               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _timescaledb_internal._hyper_X_X_chunk (actual rows=1598.00 loops=1)
                     Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
                     Filter: (_hyper_X_X_chunk.device_id = 1)
         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (actual rows=5038.00 loops=1)
               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
               Reverse: true
               Bulk Decompression: true
               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
                     Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
                     Index Cond: (compress_hyper_X_X_chunk.device_id = 1)
         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (actual rows=1364.00 loops=1)
               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
               Reverse: true
               Bulk Decompression: true
               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (actual rows=3.00 loops=1)
                     Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
                     Index Cond: (compress_hyper_X_X_chunk.device_id = 1)

EXPLAIN (ANALYZE, VERBOSE, COSTS OFF, TIMING OFF, SUMMARY OFF, BUFFERS OFF)
SELECT time, device_id, v0 FROM metrics_compressed
WHERE device_id = 1
ORDER BY time
OFFSET 10000;
--- QUERY PLAN ---
 Limit (actual rows=3674.00 loops=1)
   Output: metrics_compressed."time", metrics_compressed.device_id, metrics_compressed.v0
   ->  Custom Scan (ChunkAppend) on public.metrics_compressed (actual rows=13674.00 loops=1)
         Output: metrics_compressed."time", metrics_compressed.device_id, metrics_compressed.v0
         Order: metrics_compressed."time"
         Startup Exclusion: false
         Runtime Exclusion: false
         ->  Merge Append (actual rows=3598.00 loops=1)
               Sort Key: metrics_compressed."time"
               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (actual rows=2000.00 loops=1)
                     Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
                     Filter: (_hyper_X_X_chunk.device_id = 1)
                     Chunk Status: PARTIAL
                     Reverse: true
                     Bulk Decompression: true
                     ->  Sort (actual rows=2.00 loops=1)
                           Output: compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk._ts_meta_count
                           Sort Key: compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
                           Sort Method: quicksort 
                           ->  Seq Scan on _timescaledb_internal.compress_hyper_X_X_chunk (actual rows=2.00 loops=1)
                                 Output: compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk._ts_meta_count
                                 Filter: (compress_hyper_X_X_chunk.device_id = 1)
                                 Rows Removed by Filter: 16
               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _timescaledb_internal._hyper_X_X_chunk (actual rows=1598.00 loops=1)
                     Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
                     Filter: (_hyper_X_X_chunk.device_id = 1)
         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (actual rows=5038.00 loops=1)
               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
               Reverse: true
               Bulk Decompression: true
               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
                     Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
                     Index Cond: (compress_hyper_X_X_chunk.device_id = 1)
         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (actual rows=5038.00 loops=1)
               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
               Reverse: true
               Bulk Decompression: true
               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
                     Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
                     Index Cond: (compress_hyper_X_X_chunk.device_id = 1)

EXPLAIN (ANALYZE, VERBOSE, COSTS OFF, TIMING OFF, SUMMARY OFF, BUFFERS OFF)
SELECT time, device_id, v0 FROM metrics_compressed
WHERE device_id = 1
ORDER BY time
LIMIT 70 OFFSET 70;
--- QUERY PLAN ---
 Limit (actual rows=70.00 loops=1)
   Output: metrics_compressed."time", metrics_compressed.device_id, metrics_compressed.v0
   ->  Custom Scan (ChunkAppend) on public.metrics_compressed (actual rows=140.00 loops=1)
         Output: metrics_compressed."time", metrics_compressed.device_id, metrics_compressed.v0
         Order: metrics_compressed."time"
         Startup Exclusion: false
         Runtime Exclusion: false
         ->  Merge Append (actual rows=140.00 loops=1)
               Sort Key: metrics_compressed."time"
               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (actual rows=1.00 loops=1)
                     Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
                     Filter: (_hyper_X_X_chunk.device_id = 1)
                     Chunk Status: PARTIAL
                     Reverse: true
                     Bulk Decompression: false
                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
                           Output: compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk._ts_meta_count
                           Index Cond: (compress_hyper_X_X_chunk.device_id = 1)
               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _timescaledb_internal._hyper_X_X_chunk (actual rows=140.00 loops=1)
                     Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
                     Filter: (_hyper_X_X_chunk.device_id = 1)
         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (never executed)
               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
               Reverse: true
               Bulk Decompression: false
               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (never executed)
                     Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
                     Index Cond: (compress_hyper_X_X_chunk.device_id = 1)
         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (never executed)
               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
               Reverse: true
               Bulk Decompression: false
               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (never executed)
                     Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
                     Index Cond: (compress_hyper_X_X_chunk.device_id = 1)

EXPLAIN (ANALYZE, VERBOSE, COSTS OFF, TIMING OFF, SUMMARY OFF, BUFFERS OFF)
SELECT time, device_id, v0 FROM metrics_compressed
WHERE device_id = 1
ORDER BY time
LIMIT 1 OFFSET 1;
--- QUERY PLAN ---
 Limit (actual rows=1.00 loops=1)
   Output: metrics_compressed."time", metrics_compressed.device_id, metrics_compressed.v0
   ->  Custom Scan (ChunkAppend) on public.metrics_compressed (actual rows=2.00 loops=1)
         Output: metrics_compressed."time", metrics_compressed.device_id, metrics_compressed.v0
         Order: metrics_compressed."time"
         Startup Exclusion: false
         Runtime Exclusion: false
         ->  Merge Append (actual rows=2.00 loops=1)
               Sort Key: metrics_compressed."time"
               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (actual rows=1.00 loops=1)
                     Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
                     Filter: (_hyper_X_X_chunk.device_id = 1)
                     Chunk Status: PARTIAL
                     Reverse: true
                     Bulk Decompression: false
                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
                           Output: compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk._ts_meta_count
                           Index Cond: (compress_hyper_X_X_chunk.device_id = 1)
               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _timescaledb_internal._hyper_X_X_chunk (actual rows=2.00 loops=1)
                     Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
                     Filter: (_hyper_X_X_chunk.device_id = 1)
         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (never executed)
               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
               Reverse: true
               Bulk Decompression: false
               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (never executed)
                     Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
                     Index Cond: (compress_hyper_X_X_chunk.device_id = 1)
         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (never executed)
               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
               Reverse: true
               Bulk Decompression: false
               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (never executed)
                     Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
                     Index Cond: (compress_hyper_X_X_chunk.device_id = 1)

EXPLAIN (ANALYZE, VERBOSE, COSTS OFF, TIMING OFF, SUMMARY OFF, BUFFERS OFF)
SELECT time, device_id, v0 FROM metrics_compressed
WHERE device_id = 1
ORDER BY v0
LIMIT 1 OFFSET 1;
--- QUERY PLAN ---
 Limit (actual rows=1.00 loops=1)
   Output: metrics_compressed."time", metrics_compressed.device_id, metrics_compressed.v0
   ->  Merge Append (actual rows=2.00 loops=1)
         Sort Key: metrics_compressed.v0
         ->  Sort (actual rows=1.00 loops=1)
               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
               Sort Key: _hyper_X_X_chunk.v0
               Sort Method: top-N heapsort 
               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (actual rows=2000.00 loops=1)
                     Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
                     Filter: (_hyper_X_X_chunk.device_id = 1)
                     Chunk Status: PARTIAL
                     Bulk Decompression: true
                     ->  Seq Scan on _timescaledb_internal.compress_hyper_X_X_chunk (actual rows=2.00 loops=1)
                           Output: compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk._ts_meta_count
                           Filter: (compress_hyper_X_X_chunk.device_id = 1)
                           Rows Removed by Filter: 16
         ->  Sort (actual rows=1.00 loops=1)
               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
               Sort Key: _hyper_X_X_chunk.v0
               Sort Method: top-N heapsort 
               ->  Seq Scan on _timescaledb_internal._hyper_X_X_chunk (actual rows=1598.00 loops=1)
                     Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
                     Filter: (_hyper_X_X_chunk.device_id = 1)
         ->  Sort (actual rows=2.00 loops=1)
               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
               Sort Key: _hyper_X_X_chunk.v0
               Sort Method: top-N heapsort 
               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (actual rows=5038.00 loops=1)
                     Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
                     Bulk Decompression: true
                     ->  Seq Scan on _timescaledb_internal.compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
                           Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
                           Filter: (compress_hyper_X_X_chunk.device_id = 1)
                           Rows Removed by Filter: 24
         ->  Sort (actual rows=1.00 loops=1)
               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
               Sort Key: _hyper_X_X_chunk.v0
               Sort Method: top-N heapsort 
               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (actual rows=5038.00 loops=1)
                     Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
                     Bulk Decompression: true
                     ->  Seq Scan on _timescaledb_internal.compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
                           Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
                           Filter: (compress_hyper_X_X_chunk.device_id = 1)
                           Rows Removed by Filter: 24

EXPLAIN (ANALYZE, VERBOSE, COSTS OFF, TIMING OFF, SUMMARY OFF, BUFFERS OFF)
SELECT time, device_id, v0 FROM metrics_compressed
WHERE device_id = 1
ORDER BY time
LIMIT 1::numeric;
--- QUERY PLAN ---
 Limit (actual rows=1.00 loops=1)
   Output: metrics_compressed."time", metrics_compressed.device_id, metrics_compressed.v0
   ->  Custom Scan (ChunkAppend) on public.metrics_compressed (actual rows=1.00 loops=1)
         Output: metrics_compressed."time", metrics_compressed.device_id, metrics_compressed.v0
         Order: metrics_compressed."time"
         Startup Exclusion: false
         Runtime Exclusion: false
         ->  Merge Append (actual rows=1.00 loops=1)
               Sort Key: metrics_compressed."time"
               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (actual rows=1.00 loops=1)
                     Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
                     Filter: (_hyper_X_X_chunk.device_id = 1)
                     Chunk Status: PARTIAL
                     Reverse: true
                     Bulk Decompression: false
                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
                           Output: compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk._ts_meta_count
                           Index Cond: (compress_hyper_X_X_chunk.device_id = 1)
               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _timescaledb_internal._hyper_X_X_chunk (actual rows=1.00 loops=1)
                     Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
                     Filter: (_hyper_X_X_chunk.device_id = 1)
         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (never executed)
               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
               Reverse: true
               Bulk Decompression: false
               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (never executed)
                     Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
                     Index Cond: (compress_hyper_X_X_chunk.device_id = 1)
         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (never executed)
               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
               Reverse: true
               Bulk Decompression: false
               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (never executed)
                     Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
                     Index Cond: (compress_hyper_X_X_chunk.device_id = 1)

EXPLAIN (ANALYZE, VERBOSE, COSTS OFF, TIMING OFF, SUMMARY OFF, BUFFERS OFF)
SELECT time, device_id, v0 FROM metrics_compressed
WHERE device_id = 1
ORDER BY time
LIMIT 1.1;
--- QUERY PLAN ---
 Limit (actual rows=1.00 loops=1)
   Output: metrics_compressed."time", metrics_compressed.device_id, metrics_compressed.v0
   ->  Custom Scan (ChunkAppend) on public.metrics_compressed (actual rows=1.00 loops=1)
         Output: metrics_compressed."time", metrics_compressed.device_id, metrics_compressed.v0
         Order: metrics_compressed."time"
         Startup Exclusion: false
         Runtime Exclusion: false
         ->  Merge Append (actual rows=1.00 loops=1)
               Sort Key: metrics_compressed."time"
               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (actual rows=1.00 loops=1)
                     Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
                     Filter: (_hyper_X_X_chunk.device_id = 1)
                     Chunk Status: PARTIAL
                     Reverse: true
                     Bulk Decompression: false
                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
                           Output: compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk._ts_meta_count
                           Index Cond: (compress_hyper_X_X_chunk.device_id = 1)
               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _timescaledb_internal._hyper_X_X_chunk (actual rows=1.00 loops=1)
                     Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
                     Filter: (_hyper_X_X_chunk.device_id = 1)
         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (never executed)
               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
               Reverse: true
               Bulk Decompression: false
               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (never executed)
                     Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
                     Index Cond: (compress_hyper_X_X_chunk.device_id = 1)
         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (never executed)
               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
               Reverse: true
               Bulk Decompression: false
               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (never executed)
                     Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
                     Index Cond: (compress_hyper_X_X_chunk.device_id = 1)

EXPLAIN (ANALYZE, VERBOSE, COSTS OFF, TIMING OFF, SUMMARY OFF, BUFFERS OFF)
SELECT time, device_id, v0 FROM metrics_compressed
WHERE device_id = 1
ORDER BY time
LIMIT 1.1::float;
--- QUERY PLAN ---
 Limit (actual rows=1.00 loops=1)
   Output: metrics_compressed."time", metrics_compressed.device_id, metrics_compressed.v0
   ->  Custom Scan (ChunkAppend) on public.metrics_compressed (actual rows=1.00 loops=1)
         Output: metrics_compressed."time", metrics_compressed.device_id, metrics_compressed.v0
         Order: metrics_compressed."time"
         Startup Exclusion: false
         Runtime Exclusion: false
         ->  Merge Append (actual rows=1.00 loops=1)
               Sort Key: metrics_compressed."time"
               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (actual rows=1.00 loops=1)
                     Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
                     Filter: (_hyper_X_X_chunk.device_id = 1)
                     Chunk Status: PARTIAL
                     Reverse: true
                     Bulk Decompression: false
                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
                           Output: compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk._ts_meta_count
                           Index Cond: (compress_hyper_X_X_chunk.device_id = 1)
               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _timescaledb_internal._hyper_X_X_chunk (actual rows=1.00 loops=1)
                     Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
                     Filter: (_hyper_X_X_chunk.device_id = 1)
         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (never executed)
               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
               Reverse: true
               Bulk Decompression: false
               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (never executed)
                     Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
                     Index Cond: (compress_hyper_X_X_chunk.device_id = 1)
         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (never executed)
               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0
               Reverse: true
               Bulk Decompression: false
               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (never executed)
                     Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
                     Index Cond: (compress_hyper_X_X_chunk.device_id = 1)

\set ON_ERROR_STOP 0
EXPLAIN (ANALYZE, VERBOSE, COSTS OFF, TIMING OFF, SUMMARY OFF, BUFFERS OFF)
SELECT time, device_id, v0 FROM metrics_compressed
WHERE device_id = 1
ORDER BY time
LIMIT -1;
ERROR:  LIMIT must not be negative
EXPLAIN (ANALYZE, VERBOSE, COSTS OFF, TIMING OFF, SUMMARY OFF, BUFFERS OFF)
SELECT time, device_id, v0 FROM metrics_compressed
WHERE device_id = 1
ORDER BY time
OFFSET -1;
ERROR:  OFFSET must not be negative
EXPLAIN (ANALYZE, VERBOSE, COSTS OFF, TIMING OFF, SUMMARY OFF, BUFFERS OFF)
SELECT time, device_id, v0 FROM metrics_compressed
WHERE device_id = 1
ORDER BY time
LIMIT 'nan'::numeric;
ERROR:  cannot convert NaN to bigint
\set ON_ERROR_STOP 1
